<ui-view>
<div class="row body-container" has-permissions="['VACATIONS_BASIC']">
    <div class="col-xs-12">
        <div class="panel panel-default events-panel">
            <!-- Header -->
            <div class="panel-heading">
                <span translate="events.eventsTitle"></span>
            </div>
            <!-- TODO: add permissions -->
            <div class="panel-body">
                <!-- Search bar -->
                <div class="row">
                    <div class="col-md-8">
                        <div class="flex form-group search-group search-group-lg padding-bot-10">
                            <input type="text" id="search-block" class="form-control" style="display: inline-block;"
                                data-test-id="projects-filter-input" ng-change="vm.onListFilter()" ng-model="vm.filterText"
                                translate-attr-placeholder="events.filterEvents" translate>

                        </div>
                    </div>
                    <ace-dropdown-checkbox class="col-md-2 checkbox-menu-btn--mt" translation="events.eventTypesDropdownButtonTitle" types="vm.eventTypes" on-value-change="vm.eventTypesChange(types)"></ace-dropdown-checkbox>
                    <ace-dropdown-checkbox class="col-md-2 checkbox-menu-btn--mt" translation="events.eventOfficesDropdownButtonTitle"></ace-dropdown-checkbox>
                </div>

                <wave-spinner ng-if="vm.isLoadingEventTypes && !vm.isLoadingEvents"></wave-spinner>

                <!-- Content -->
                <wave-spinner ng-if="vm.isLoadingEvents"></wave-spinner>
                <table class="nc-table nc-table-active" ng-if="!vm.isLoadingEvents && vm.events.pagedList.length">
                    <thead>
                        <tr>
                            <th translate="events.tableTitle"></th>
                            <th translate="events.tableStartDate" class="hidden-xs hidden-sm">Start date</th>
                            <th translate="events.tableEndDate" class="hidden-xs hidden-sm">End date</th>
                            <th translate="events.tableType" class="hidden-xs hidden-sm">Type</th>
                            <th translate="events.tableOffices" class="hidden-xs hidden-sm">Offices</th>
                            <th translate="events.tableParticipants">Participants</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="event in vm.events.pagedList" class="pointer" ng-class="{highlightRow: book.takenByCurrentUser}" ng-click="vm.viewDetails(event.id)">
                            <td class="col-xs-4 word-break" data-test-id="book-title-and-author" ng-cloak>
                                {{event.name}}
                            </td>
                            <td class="col-xs-2 hidden-xs hidden-sm" data-test-id="reader-full-name" ng-cloak>
                                {{event.startDate | amUtc | amLocal | amDateFormat:'YYYY-MM-DD HH:mm'}}
                            </td>
                            <td class="col-xs-2 hidden-xs hidden-sm" data-test-id="book-quantity-left" ng-cloak>
                                {{event.endDate | amUtc | amLocal | amDateFormat:'YYYY-MM-DD HH:mm'}}
                            </td>
                            <td class="col-xs-2 hidden-xs hidden-sm" data-test-id="book-quantity-left" ng-cloak>
                                {{event.typeName}}
                            </td>
                            <td class="col-xs-2 hidden-xs hidden-sm" data-test-id="book-quantity-left" ng-cloak>
                                {{event.officeNames.join(', ')}}
                            </td>
                            <td class="col-xs-2" data-test-id="book-quantity-left" ng-cloak>
                                {{event.participantsCount}}/{{event.maxParticipants}}
                            </td>
                        </tr>
                    </tbody>
                </table>

                <ace-list-pagination total-item-count="vm.events.itemCount" page-size="vm.events.pageSize"
                    page-count="vm.events.pageCount" current-page="vm.page" on-changed="vm.changePage(page)">
                </ace-list-pagination>
            </div>
        </div>
    </div>
</div>
</ui-view>
